$(function(a){function b(c){this.options={container:null,itemNum:1,autoPlay:true,transition:800,speed:5000,responsive:{support:false,lgValue:1014,mdValue:734,mobileHideArrow:true},mobileTouchSpeed:400,touchTurnRatio:0.15,mobileReturnSpeed:100};this.clicked=false;this.cuted=false;this.parentWidth=0;this.turnNum=1;this.startX=0;this.moveX=0;this.autoTimer=null;this.init(c);return this}b.prototype.init=function(c){$.extend(this.options,c);this.rendUI().bindUI();return this};b.prototype.rendUI=function(){this.container=$(this.options.container);this.arrowWrap=$('<div class="arrow-wrap"><a href="javascript:void(0);" class="arrow-sprite arrow-left"></a><a href="javascript:void(0);" class="arrow-sprite arrow-right"></a></div>');this.pointerWrap=$('<div class="pointer-wrap"><ul></ul></div>');this.options.itemNum=this.container.find(".banner li").length;for(var c=0;c<this.options.itemNum;c++){var d=$("<li data-id="+c+'><a href="javascript:void(0);"></a></li>');if(c==0){d.addClass("active")}this.pointerWrap.find("ul").append(d)}this.container.append(this.arrowWrap);this.container.append(this.pointerWrap);this.resize();if(this.options.autoPlay){this.autoPlay()}return this};b.prototype.bindUI=function(){var c=this;$(a).on("resize",function(){c.resize()});this.container.find(".arrow-right").on("click",function(d){c.turnLeft()});this.container.find(".arrow-left").on("click",function(d){c.turnRight()});this.container.on("touchstart",function(d){if(c.options.itemNum==1){return false}if(c.autoTimer){clearInterval(c.autoTimer)}c.startX=event.targetTouches[0].pageX});this.container.on("touchmove",function(f){f.preventDefault();if(c.options.itemNum==1){return false}if(c.clicked){return}var d=event.targetTouches[0].pageX;c.moveX=d-c.startX;if(d>c.startX){if(!c.cuted){c.container.find(".banner").prepend(c.container.find(".banner .banner-item").last())}c.container.find(".banner").css({"margin-left":-c.parentWidth+c.moveX});c.cuted=true}else{c.container.find(".banner").css({"margin-left":c.moveX})}});this.container.on("touchend",function(f){if(c.options.itemNum==1){return false}var d=c.parentWidth*c.options.touchTurnRatio;if(c.moveX<0&&Math.abs(c.moveX)>d){c.turnLeft({speed:c.options.mobileTouchSpeed})}else{if(c.moveX>0&&Math.abs(c.moveX)>d){c.container.find(".banner").stop().animate({"margin-left":0},c.options.mobileTouchSpeed,function(){c.clicked=false;c.cuted=false;c.changePointer()})}else{if(c.moveX<0){c.container.find(".banner").stop().animate({"margin-left":0},c.options.mobileReturnSpeed)}else{if(c.moveX>0){c.container.find(".banner").stop().animate({"margin-left":-c.parentWidth},c.options.mobileReturnSpeed,function(){c.container.find(".banner").append(c.container.find(".banner .banner-item").first());c.container.find(".banner").css({"margin-left":0})});c.cuted=false}}}}if(c.options.autoPlay){c.autoPlay()}});this.container.hover(function(){if(c.options.itemNum==1){return false}if(c.autoTimer){clearInterval(c.autoTimer)}if(c.parentWidth>750){c.arrowWrap.fadeOut().stop().fadeIn()}},function(){if(c.options.itemNum==1){return false}if(c.options.autoPlay){c.autoPlay()}c.arrowWrap.fadeIn().stop().fadeOut()});this.pointerWrap.find("li a").on("click",function(){var f=c.pointerWrap.find(".active").index();var e=$(this).parent("li").data("id");if(e>f){var d=e-f;c.turnLeft({speed:c.options.transition,turnNum:d,toIndex:e})}else{if(e<f){var d=f-e;c.turnRight({speed:c.options.transition,turnNum:d,toIndex:e})}}});return this};b.prototype.resize=function(){this.parentWidth=this.container.parent().width();if(this.options.responsive.support){this.changeImg();if(this.options.responsive.mobileHideArrow){this.mobileHideArrow()}}this.container.find(".banner").width(this.options.itemNum*this.parentWidth);this.container.find(".banner .banner-item").width(this.parentWidth);return this};b.prototype.turnLeft=function(e){var f=this;if(f.options.itemNum==1){return false}if(f.clicked){return}f.clicked=true;var c=0;var d=0;if(e){e.turnNum?(c=e.turnNum):(c=f.turnNum);e.speed?(d=e.speed):(d=f.options.transition)}else{c=f.turnNum;d=f.options.transition}f.container.find(".banner").stop().animate({"margin-left":-f.parentWidth*c},d,function(){for(var g=0;g<c;g++){f.container.find(".banner").append(f.container.find(".banner .banner-item").first())}f.container.find(".banner").css({"margin-left":0});f.clicked=false;f.changePointer()})};b.prototype.turnRight=function(f){var g=this;if(g.options.itemNum==1){return false}if(g.clicked){return}g.clicked=true;var c=0;var e=0;if(f){f.turnNum?(c=f.turnNum):(c=g.turnNum);f.speed?(e=f.speed):(e=g.options.transition)}else{c=g.turnNum;e=g.options.transition}for(var d=0;d<c;d++){g.container.find(".banner").prepend(g.container.find(".banner .banner-item").last())}g.container.find(".banner").css({"margin-left":-g.parentWidth*c});g.container.find(".banner").stop().animate({"margin-left":0},e,function(){g.clicked=false;g.changePointer()})};b.prototype.changeImg=function(){var f=this;if(!f.options.responsive.support){return}var c=$(a).outerWidth(true);for(var d=0;d<f.options.itemNum;d++){var e=f.container.find(".banner img").eq(d);if(c<this.options.responsive.mdValue){e.attr("src",e.data("xs-src"))}else{if(c<this.options.responsive.lgValue){e.attr("src",e.data("md-src"))}else{e.attr("src",e.data("lg-src"))}}}return this};b.prototype.changePointer=function(){var d=this;var c=d.container.find(".banner li").eq(0).data("index");d.pointerWrap.find("li").removeClass("active").eq(c).addClass("active")};b.prototype.autoPlay=function(){var c=this;c.autoTimer=setInterval(function(){c.turnLeft()},this.options.speed);return this};b.prototype.mobileHideArrow=function(){if(this.parentWidth<this.options.responsive.mdValue){this.arrowWrap.hide()}return this};a.Banner=b}(window));
