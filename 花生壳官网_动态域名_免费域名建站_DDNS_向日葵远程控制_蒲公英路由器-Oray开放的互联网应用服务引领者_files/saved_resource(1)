var OR=OR||{};OR.loginWin=null;OR.user={uid:"",account:""};OR.getDomain=function(){var d="oray.com";var c=window.location.host;var a=["oray.com","oray.net","oray.cn"];for(var b=0;b<a.length;b++){if(c.indexOf(a[b])!=-1){d=a[b];break}}return d};OR.initLoginInfo=function(c){c=c||{};document.domain=OR.getDomain();var f=c.login||"https://login.oray.com";var e=$.cookie("_account_"),d=$.cookie("_uid_");OR.user={account:e,uid:d};var a=c.platform||"index";b();$.ajax({type:"GET",dataType:"jsonp",jsonp:"callback",jsonpCallback:"userHandler",url:f+"/login/check?rand="+Math.random(),async:false,success:function(g){OR.user=g;b()}});function b(){var l=OR.user.account,m=OR.user.uid,h=c.console||"https://console.oray.com",n=c.loginUrl||h+"/passport/login",k=c.logoutUrl||h+"/passport/logout",i=h+"/passport/register.html";var o=location.href;if(/^http.*(\/passport\/login)$/i.test(o)){o=""}var g=c.redirect||o;if(g){n+="?url="+encodeURIComponent(g);i+="?fromurl="+encodeURIComponent(g);k+="?url="+encodeURIComponent(g)}var j="";if(l&&m){j=['<a class="user-name">'+l+'<span class="arrow"></span></a>','<div id="menu-user" class="nav-menu" style="display:none;right:0">',"<ul>",'<li><a href="'+c.console+'" style="padding-left: 15px"><span class="icon icon-account"></span>'+l+"</a></li>",'<li><a href="'+k+'" target="_top" style="padding-left: 15px"><span class="icon icon-logout"></span>\u9000\u51fa\u767b\u5f55</a></li>',"</ul>","</div>"].join("");$('[data-name="login-info"]').on("mouseenter mouseleave",function(q){var p=$(this);if(q.type=="mouseenter"){p.find("#menu-user").show()}else{p.find("#menu-user").hide()}})}else{j=['<a href="'+n+'"  data-login="true" data-url="'+g+'">\u767b\u5f55</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="'+i+'" class="register">\u6ce8\u518c</a>'].join("")}$('[data-name="login-info"]').html(j)}OR.initLogin(c)};OR.initLogin=function(a){$("[data-login='true']").unbind("click");$("[data-login='true']").on("click",function(){if(OR.user.uid==""||null==OR.user.uid){var c=this.href;if($(this).data("url")){c=$(this).data("url")}var b="common";if(typeof a.tplname!="undefined"){b=a.tplname}var d=a.login+"/login?tplname="+b+"&target=parent&s_url="+encodeURIComponent(c);if($(this).data("callback")){callback=$(this).data("callback");d=a.login+"/login?tplname="+b+"&callback="+callback+"&target=parent&s_url="+encodeURIComponent(c)}OR.showLoginWin(a["static"],d);return false}})};OR.showLoginWin=function(b,a){var c=['<div id="login-win" class="window-wrapper"><div class="window">','<div class="window-opt"><a href="javascript:void(0)" class="iconfont close">&#xe61f;</a></div>','<div class="window-body">','<div style="text-align:center;height:100%;width:100%"><img src="'+b+'/console/img/loading_big.gif" border="0" style="margin-top:120px;"></div>','<iframe width="100%" height="100%" scrolling="no" frameborder="0" name="loginframe" style="position:absolute;top:0;left:0;" src="'+a+'"></iframe>',"</div></div></div>"].join("");OR.loginWin=$(c).window({width:482,height:320,closeCls:"close",draggable:false,center:true,destroy:true,blankCls:".window-wrapper",show:function(){}});OR.loginWin.show()};function closeLoginWin(){if(null!==OR.loginWin){OR.loginWin.close()}};
var OR=OR||{};OR.L={ERROR:"\u7f51\u7edc\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\u2026",LOADING:"\u6b63\u5728\u83b7\u53d6\u6570\u636e\uff0c\u8bf7\u7a0d\u5019\u2026",POSTDATA:"\u6b63\u5728\u63d0\u4ea4\u6570\u636e\uff0c\u8bf7\u7a0d\u5019\u2026"};OR.Header=function(a){return{writeLoginInfo:function(l){l=l||{};var h=a.cookie("_account_"),i=a.cookie("_uid_"),c=l.www||"http://www.oray.com",d=l.console||"https://console.oray.com",j=l.loginUrl||d+"/passport/login",g=l.logoutUrl||d+"/passport/logout",e=d+"/passport/register.html";var k=location.href;if(/^http.*(\/passport\/login)$/i.test(k)){k=""}var b=l.redirect||k;if(b){j+="?url="+encodeURIComponent(b);e+="?fromurl="+encodeURIComponent(b)}var f="";if(h&&i){f="\u60a8\u597d\uff0c"+h+"&nbsp;&nbsp;\u670d\u52a1ID\uff1a"+i+'&nbsp;[<a href="'+g+'" target="_top">\u9000\u51fa</a>]'}else{f='<a href="'+j+'" target="_top">\u767b\u5f55</a>&nbsp;-&nbsp;<a href="'+e+'" target="_blank">\u6ce8\u518c</a>'}if(l.renderTo){a(l.renderTo).append(f)}else{document.write(f)}}}}(jQuery);OR.Common=function(a){return{attachment:{_form:null,_queue:[],count:0,uploaded:{},init:function(d){var c=false,b=this;this._queue=[];d.find("[type=file]:enabled").each(function(g,f){f=a(f);var h=f.attr("_name");var e=f.attr("_optional");if(b.uploaded[h]){return}if(f.val()==""){if(e){return}f.focus();c=true;return OR.Common.showMessage("\u8bf7\u4e0a\u4f20"+f.attr("title"),false)}b._queue.push(f)});this.count=this._queue.length;this._form=d;return !c},upload:function(b){if(!this._queue||!this._form||!b){return}var c=this._form;a.each(this._queue,function(f,e){var d=e.data("type")?b+"&type="+e.data("type"):b;a.ajaxUpload({url:d,file:e[0],data:[{name:"callback",value:'document.domain="'+document.domain+'";window.top.OR.Common.attachment.callback(%s,"'+f+'")'}],dataType:"x-callback",beforeSend:function(){c.find("[type=file][_name="+e.attr("_name")+"]").attr("disabled",true)},complete:function(){if(!e.attr("_upload")){alert("\u4e0a\u4f20 "+e.attr("title")+" \u5931\u8d25\uff0c\u8bf7\u4e0d\u8981\u4e0a\u4f20\u8d85\u8fc72M\u7684\u6587\u4ef6\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u91cd\u8bd5")}}})})},callback:function(b,d){var c=this._queue[d];c.attr("_upload",true);if(b.success){this.count--;this.uploaded[c.attr("_name")]=b.name;if(this.count<1){var e="";a.each(this.uploaded,function(g,f){e+=g+"|"+f+"\n"});this._form.find("[name=attachment]").val(e);this._form.submit()}}else{this._form.find("[type=file][_name="+c.attr("_name")+"]:not([_disabled])").removeAttr("disabled").focus();OR.Common.showMessage(c.attr("title")+"\u9519\u8bef\uff1a"+b.message,false)}}},ajax:function(c){var b=c.success;delete c.success;c=a.extend({success:function(e,d,f){if("json"==this.dataType&&e.sesstimeout){OR.Common.showMessage(e.message,false,0);return}if(b){b.call(this,e,d,f)}},error:function(d){OR.Common.showMessage(OR.L.ERROR,false);return false}},c);return a.ajax(c)},showMessage:function(e,d,b,f){var c=a("#msg-info");if(!c.size()){c=a('<div id="msg-info" class="msg"><span></span></div>');c.prependTo(document.body)}if(c[0].timer){clearTimeout(c[0].timer)}if(!e){return c.fadeOut()}if(typeof(b)!="number"){b=6000}c.find("span:eq(0)").toggleClass("error",!(d==undefined||d)).html(e);if(c.is(":hidden")){c.fadeIn()}if(b>0){c[0].timer=setTimeout(function(){c.fadeOut("normal",f)},b)}return d},unload:function(){},copyToClipBoard:function(f,k){if(window.clipboardData){window.clipboardData.clearData();window.clipboardData.setData("Text",f)}else{if(navigator.userAgent.indexOf("Opera")!=-1){window.location=f}else{if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(h){return alert("\u88ab\u6d4f\u89c8\u5668\u62d2\u7edd\uff01\n\u8bf7\u5728\u6d4f\u89c8\u5668\u5730\u5740\u680f\u8f93\u5165'about:config'\u5e76\u56de\u8f66\n\u7136\u540e\u5c06'signed.applets.codebase_principal_support'\u8bbe\u7f6e\u4e3a'true'")}var d=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!d){return}var j=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!j){return}j.addDataFlavor("text/unicode");var i=new Object();var g=new Object();var i=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);var c=f;i.data=c;j.setTransferData("text/unicode",i,c.length*2);var b=Components.interfaces.nsIClipboard;if(!d){return false}d.setData(j,null,b.kGlobalClipboard)}}}if(k!=undefined){OR.Common.showMessage(k)}}}}(jQuery);(function(c){c.fn.rowOver=function(e,f){if(!e){e="over"}if(!f){f="odd"}this.filter(":odd").addClass(f);return this.hover(function(){c(this).addClass(e)},function(){c(this).removeClass(e)})};c.fn.scrollToY=function(){window.scrollTo(0,this.offset().top);return this};c.fn.disabled=function(f){var e=this.attr("tagName")||this[0].tagName+"";if(e&&e.toLowerCase()=="form"){if(!f){f=":input"}this.find(f).attr("disabled",true)}else{this.attr("disabled",true)}return this};c.fn.enabled=function(f){var e=this.attr("tagName")||this[0].tagName+"";if(e&&e.toLowerCase()=="form"){if(!f){f=":input"}this.find(f).removeAttr("disabled")}else{this.removeAttr("disabled")}return this};c.fn.checkBoxAll=function(e,f){f=f!=undefined?ischecked:this.attr("checked");c(':checkbox[name="'+e+'"]:enabled:visible').attr("checked",f)};c.fn.stopEventBubble=function(f){if(null==f){return}f.cancelBubble=true;if(f.stopPropagation){f.stopPropagation()}};c.fn.keyHint=function(e,f){if(!e){e="gray"}return this.each(function(){c.keyHint(this,e,f)})};c.keyHint=function(e,f,g){e=c(e);e.focus(function(){e.filter("."+f).removeClass(f).val("")}).blur(function(){if(this.value==""){var h=c(this).attr("placeholder")||this.placeholder||this.title;e.addClass(f).val(h)}}).each(function(){var h=c(this).attr("placeholder")||this.placeholder||this.title;if(this.value==""||this.value==h){e.addClass(f).val(h)}}).keypress(function(h){if(e.is("."+f)){e.removeClass(f).val("")}});e.parents("form:eq(0)").submit(function(){e.filter("."+f).removeClass(f).val("");if(null===g){return}if(!c.isFunction(g)){g=c.keyHint.callback}return g.call(e[0],this)})};c.keyHint.callback=function(e){input=c(this);if(!c.trim(input.val())){OR.Common.showMessage(input.attr("title"),false);input.focus();return false}return true};c.cookie=function(f,m,q){if(typeof m!="undefined"){q=q||{};if(m===null){m="";q.expires=-1}var h="";if(q.expires&&(typeof q.expires=="number"||q.expires.toUTCString)){var j;if(typeof q.expires=="number"){j=new Date();j.setTime(j.getTime()+(q.expires*24*60*60*1000))}else{j=q.expires}h="; expires="+j.toUTCString()}var p=q.path?"; path="+q.path:"";var k=q.domain?"; domain="+q.domain:"";var e=q.secure?"; secure":"";document.cookie=[f,"=",encodeURIComponent(m),h,p,k,e].join("")}else{var n=null;if(document.cookie&&document.cookie!=""){var o=document.cookie.split(";");for(var l=0;l<o.length;l++){var g=c.trim(o[l]);if(g.substring(0,f.length+1)==(f+"=")){n=decodeURIComponent(g.substring(f.length+1));break}}}return n}};c.func={intVal:function(e){e=parseInt(e,10);return isNaN(e)?0:e},parseStr:function(g){var f=g.replace(/^#+|^\?/,"");var e=[];c(f.split("&")).each(function(){var h=this.split("=",2);e[h[0]]=h[1]?decodeURIComponent(h[1].replace(/\+/g," ")):null});return e},parseDateTime:function(e){var h=new Date();var f=0;var g;var i;e=e.split(" ");if(e.length==2){g=e[0];i=e[1]}else{if(e.length=1){g=e[0];i=" "}else{return null}}g=g.split("-");if(g.length!=3){return null}else{f=parseInt(g[0],10);if(f!=NaN){h.setFullYear(f)}f=parseInt(g[1],10);if(f!=NaN){h.setMonth(f-1)}f=parseInt(g[2],10);if(f!=NaN){h.setDate(f)}}i=i.split(":");if(i.length==3){f=parseInt(i[0],10);if(f!=NaN){h.setHours(f)}f=parseInt(i[1],10);if(f!=NaN){h.setMinutes(f)}f=parseInt(i[2],10);if(f!=NaN){h.setSeconds(f)}}return h},isEmail:function(f){var e=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i;return e.test(f)},isMobile:function(f){var e=/^1[0-9]{10}$|^852[69]{1}[0-9]{7}$|^88609[0-9]{8}$|^853[6]{1}[0-9]{7}$/;return e.test(f)},isIp:function(f){var e=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])(\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])){3}$/;return e.test(f)},isDomainName:function(k,m,l){var h=k.split(".");if(h.length==1||k.length<4||k.length>254){return false}var g=h.pop();var i=(g=="\u4e2d\u56fd"||g=="\u516c\u53f8"||g=="\u7f51\u7edc"||g=="\u9999\u6e2f");var j=(g=="\u516c\u53f8"||g=="\u7f51\u7edc"||g=="\u9999\u6e2f");if(!/[a-z]{2,10}$/i.test(g)&&(m===false||!i)){return false}if(l&&h.length>1&&h[0]=="*"){h.shift()}if(j){var f=h.pop();if(!this.isDomainStr(f,false)){return false}}var e=(m===false)?true:null;while(f=h.shift()){if(!this.isDomainStr(f,e)){return false}}return true},isDomainStr:function(f,e){if(e===true){reg=/^[0-9a-z]+(-[0-9a-z]+)*$/i}else{reg=/^[0-9a-z\u4E00-\u9FA5]+(-[0-9a-z\u4E00-\u9FA5]+)*$/i}if(!reg.test(f)){return false}reg=/[\u4E00-\u9FA5]/;if(e===false&&!reg.test(f)){return false}return true}};String.prototype.toInt=function(){return c.func.intVal(this)};var b=navigator.userAgent.toLowerCase();if(-1!=b.indexOf("msie")){var a=~~b.substring(b.indexOf("msie")+5,b.indexOf("msie")+6);if(a<=6){try{document.execCommand("BackgroundImageCache",false,true)}catch(d){}}}c.fn.menu=function(r){var i=null;var h=null;var g=null;var e=null;var n=500;var k=300;if(r){i=r}var f=this[0];var q=c("> ul > li",f);var p=c("> ul > li > a[name]",f);var j=p.next();q.hover(function(){h=c(this).children("a")[0].name;e=setTimeout(function(){o(h,true)},k);if(j.filter(":visible").size()){o(h,true)}},function(){g=setTimeout(function(){m()},n);if(e){clearTimeout(e)}});p.filter("[name="+i+"]").addClass("current");m();function o(t,s){l();if(t==null){p.removeClass("current").filter("[name="+i+"]").addClass("current");j.filter(":visible").hide();return}p.each(function(){if(this.name==t){c(this).addClass("current");if(s){c(this).next().show()}else{c(this).next().hide()}}else{c(this).removeClass("current").filter("[name="+i+"]").addClass("current");c(this).next().hide()}})}function m(){o(i,false)}function l(){if(g){clearTimeout(g)}}};c.fn.addFiexd=function(g){var l=c(this).attr("data-contentid");c(this).find("li").click(function(){if(c(this).find("a").attr("data-type")&&c(this).find("a").attr("data-type")=="link"){return}c("#"+l).children().eq(c(this).index()).show().siblings().hide();c(this).addClass(g.selectClass).siblings().removeClass(g.selectClass)});var f=true;var i;if(c(this).next().css("marginTop")=="auto"){i=0}else{i=parseInt(c(this).next().css("marginTop"))}if(c(this).next().offset()){var j=parseInt(c(this).next().offset().top)}var e=parseInt(c(this).height());var h;if(g.hasOwnProperty("showTop")){h=g.showTop}else{if(i){h=j-i-e}else{h=j-e}}if(g.hasOwnProperty("bottom")){c(this).css({top:"auto",bottom:g.bottom})}else{if(g.hasOwnProperty("top")){c(this).css({bottom:"auto",top:g.top})}}var k=this;c(window).scroll(function(){var m=c(window).scrollTop();if(m>h){c(k).next().css("marginTop",e+i);c(k).addClass("fixed");if(g.animate){if(f){c(k).css({height:0});c(k).animate({height:e},500,function(){if(g.callBack){g.callBack(k)}});f=false}}}else{c(k).next().css("marginTop",i);c(k).removeClass("fixed");f=true}if(g.hasOwnProperty("hideTop")&&m<g.hideTop){return}else{if(g.hasOwnProperty("hideTop")){c(k).next().css("marginTop",i);c(k).removeClass("fixed")}}c(k).css("left",-c(document).scrollLeft())})}})(jQuery);
